<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barcode Scanner</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
</head>
<body>
    <div class="container">
        <h3 class="center-align">Barcode Scanner</h3>
        <div class="row">
            <div class="col s12">
                <div class="card">
                    <div class="card-content">
                        <span class="card-title">Resultado:</span>
                        <p id="barcode-result"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://unpkg.com/@zxing/library@0.24.0/umd/index.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const barcodeResult = document.getElementById('barcode-result');

            navigator.mediaDevices.getUserMedia({ video: true })
                .then(function (stream) {
                    const barcodeReader = new ZXing.BrowserBarcodeReader();

                    barcodeReader.decodeFromStream(stream, function (result, error) {
                        if (result) {
                            barcodeResult.innerHTML = result.text;
                        } else {
                            barcodeResult.innerHTML = 'Erro ao ler código de barras.';
                        }

                        stream.getTracks().forEach(track => track.stop());
                    });
                })
                .catch(function (error) {
                    barcodeResult.innerHTML = 'Erro ao acessar a câmera. Verifique se o acesso à câmera está permitido e se você está usando uma conexão segura (HTTPS).';
                    console.error('Erro ao acessar a câmera:', error);
                });
        });
    </script>
</body>
</html>
